# 公众号接口 - 模板消息模块

#### 1 给公众号添加模板
* **协议**： HTTPS
* **方法**： POST
* **URL**： /v1/tpl/sys_tpls
* **参数**：  
        * siteId: 站点id  
        * templateId：模板的id  

        
* **说明**：  
        * 此接口实现为同步模式, 最多需要与微信api交互两次，超时时间请设置大一点(5s)  
        * 此接口支持幂等操作

* **返回**：
    * 获取成功时返回:

        ```
        {}
        ```
        
    * 异常情况: 
        * siteId不存在或未绑定公众号 返回码 102002
        * 账号不是认证服务号，不能添加模板 返回码 102004
        * 公众号模板数量已达上限  返回码 108004
        * 公众号行业设置错误，不能添加模板 返回码 108005
        
#### 2 发送系统模板消息
* **协议**： HTTPS
* **方法**： POST
* **URL**： /v1/tpl/sys_tpl_msgs
* **参数**：  
        * siteId: 站点id  
        * templateId：模板的id  
        * openId: 发送的对象  
        * url: 模板消息的跳转链接，非必须  
        * data: 模板消息的json数据  
* **传参示例**：
    ```
    {
    	"siteId": 4218098471,
    	"openId": "oBGGJt5SLU9P_wGu71Xo82m_Zq1s",
    	"templateId": "OPENTM213512088",
    	"url": "www.baidu.com",
    	"data": {  
                   "first": {
                     "value":"您有待办事项",
                     "color":"#000000"     // color字段决定了模板消息值的颜色，不传字段默认为黑色
                   },
                   "keyword1":{
                       "value":"给老板回邮件",
                       "color":"#000000"
                   },
                   "keyword2": {
                       "value":"晚上8点钟",
                       "color":"#173177"
                   },
                   "remark":{
                       "value":"点击查看详情",
                       "color":"#000000"
                   }
    	}
    }
    ```

* **返回**：
    * 获取成功时返回:

        ```
        {}
        ```
        
    * 异常情况: 
        * siteId不存在或未绑定公众号 返回码 102002
        * data数据格式错误 返回码 108001 // 模板定义中必须的字段，data数据中不能缺省
        * 非法的模板消息id 返回码 108002  // 只能传指定的模板消息id
        * 公众号没有添加此模板消息，或者在微信后台被删除 108003  // 社区收到此返回码，说明用户的模板设置出现问题，应该进行相关处理。

